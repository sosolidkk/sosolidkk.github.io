<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>PSQL | &lt;~brain dump/&gt;</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="PSQL" />
<meta name="author" content="João Pedro" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This one will also be another post about configuration since configuring Postgres and its user will always be a pain in the ass for me. Shall we? Installation $ sudo pacman -S postgresql Initial configuration After the succeeded installation, you can now switch to the postgres user using a privilege elevation program like: $ sudo su - postgres Before PostgreSQL can function correctly, the database cluster must be initialized: [postgres@{machine_name} ~]$ initdb -D /var/lib/postgres/data # If everything runs successfully you should see this output The database cluster will be initialized with locales COLLATE: en_US.UTF-8 CTYPE: en_US.UTF-8 MESSAGES: en_US.UTF-8 MONETARY: pt_BR.UTF-8 NUMERIC: pt_BR.UTF-8 TIME: pt_BR.UTF-8 The default database encoding has accordingly been set to &quot;UTF8&quot;. The default text search configuration will be set to &quot;english&quot;. Data page checksums are disabled. fixing permissions on existing directory /var/lib/postgres/data ... ok creating subdirectories ... ok selecting dynamic shared memory implementation ... posix selecting default max_connections ... 100 selecting default shared_buffers ... 128MB selecting default time zone ... America/Fortaleza creating configuration files ... ok running bootstrap script ... ok performing post-bootstrap initialization ... ok syncing data to disk ... ok initdb: warning: enabling &quot;trust&quot; authentication for local connections You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb. Success. You can now start the database server using: pg_ctl -D /var/lib/postgres/data -l logfile start Start postgreSQL: $ sudo systemctl start postgresql Enable postgreSQL service: $ sudo systemctl enable postgresql Check if PostgreSQL is active and running: ● postgresql.service - PostgreSQL database server Loaded: loaded (/usr/lib/systemd/system/postgresql.service; enabled; vendo&gt; Active: active (running) since Sun 2022-02-20 09:54:51 -03; 12s ago Main PID: 9057 (postgres) Tasks: 7 (limit: 19091) Memory: 15.8M CPU: 102ms CGroup: /system.slice/postgresql.service ├─9057 /usr/bin/postgres -D /var/lib/postgres/data ├─9059 &quot;postgres: checkpointer &quot; ├─9060 &quot;postgres: background writer &quot; ├─9061 &quot;postgres: walwriter &quot; ├─9062 &quot;postgres: autovacuum launcher &quot; ├─9063 &quot;postgres: stats collector &quot; └─9064 &quot;postgres: logical replication launcher &quot; fev 20 09:54:50 ws systemd[1]: Starting PostgreSQL database server... fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.090 -03 [9057] LOG: starting PostgreSQL 13.4 on x86_64-pc-linux-gnu, compiled by gcc (GCC) 11.1.0, 64-bit fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.091 -03 [9057] LOG: listening on IPv6 address &quot;::1&quot;, port 5432 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.091 -03 [9057] LOG: listening on IPv4 address &quot;127.0.0.1&quot;, port 5432 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.094 -03 [9057] LOG: listening on Unix socket &quot;/run/postgresql/.s.PGSQL.5432&quot; fev 20 09:54:51 ws postgres[9058]: 2022-02-20 09:54:51.100 -03 [9058] LOG: database system was shut down at 2022-02-20 09:52:34 -03 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.105 -03 [9057] LOG: database system is ready to accept connections fev 20 09:54:51 ws systemd[1]: Started PostgreSQL database server. Create Database in PostgreSQL To create a valid database, we first need a User. We can take advantage of the user that the system already makes available to us. $ sudo su - postgres Secure this default postgres user with a password: $ psql -c &quot;ALTER USER postgres WITH PASSWORD &#39;{new_password}&#39;&quot; To test and execute commands, let’s use the PostgreSQL cli. Type: psql Run the following command to create a database and then type \l to list the already created databases: CREATE DATABASE mydb; Create an User in PostgreSQL If you want a more assisted way, run this command: createuser --interactive --pwprompt If not, you can run those two to create a User with a password defined and a proper role for it: CREATE USER {user_name} WITH ENCRYPTED PASSWORD &#39;{user_password}&#39;; GRANT ALL PRIVILEGES ON DATABASE {db_name} TO {username}; Useful commands to run when using PSQL Login in to your user, run the psql command, and type: Connect to a database: \c {db_name} {username} List available databases: \l List available tables: \dt or \dt+ Describe a table: \d {table_name} List available schema: \dn List available functions: \df List available views: \dv List users and their roles: \du Execute the previous command (psql executes the previous command again, which is the SELECT statement): SELECT version(); \g Command history: \s Execute psql commands from a file: \i {filename} Turn on query execution time: db_name=# \timing Timing is on. db_name=# SELECT COUNT(*) FROM table; count ------- 1000 (1 row) Time: 0.495 ms db_name=# Edit command in your own editor. It will open the text editor defined in the EDITOR environment variable: \e" />
<meta property="og:description" content="This one will also be another post about configuration since configuring Postgres and its user will always be a pain in the ass for me. Shall we? Installation $ sudo pacman -S postgresql Initial configuration After the succeeded installation, you can now switch to the postgres user using a privilege elevation program like: $ sudo su - postgres Before PostgreSQL can function correctly, the database cluster must be initialized: [postgres@{machine_name} ~]$ initdb -D /var/lib/postgres/data # If everything runs successfully you should see this output The database cluster will be initialized with locales COLLATE: en_US.UTF-8 CTYPE: en_US.UTF-8 MESSAGES: en_US.UTF-8 MONETARY: pt_BR.UTF-8 NUMERIC: pt_BR.UTF-8 TIME: pt_BR.UTF-8 The default database encoding has accordingly been set to &quot;UTF8&quot;. The default text search configuration will be set to &quot;english&quot;. Data page checksums are disabled. fixing permissions on existing directory /var/lib/postgres/data ... ok creating subdirectories ... ok selecting dynamic shared memory implementation ... posix selecting default max_connections ... 100 selecting default shared_buffers ... 128MB selecting default time zone ... America/Fortaleza creating configuration files ... ok running bootstrap script ... ok performing post-bootstrap initialization ... ok syncing data to disk ... ok initdb: warning: enabling &quot;trust&quot; authentication for local connections You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb. Success. You can now start the database server using: pg_ctl -D /var/lib/postgres/data -l logfile start Start postgreSQL: $ sudo systemctl start postgresql Enable postgreSQL service: $ sudo systemctl enable postgresql Check if PostgreSQL is active and running: ● postgresql.service - PostgreSQL database server Loaded: loaded (/usr/lib/systemd/system/postgresql.service; enabled; vendo&gt; Active: active (running) since Sun 2022-02-20 09:54:51 -03; 12s ago Main PID: 9057 (postgres) Tasks: 7 (limit: 19091) Memory: 15.8M CPU: 102ms CGroup: /system.slice/postgresql.service ├─9057 /usr/bin/postgres -D /var/lib/postgres/data ├─9059 &quot;postgres: checkpointer &quot; ├─9060 &quot;postgres: background writer &quot; ├─9061 &quot;postgres: walwriter &quot; ├─9062 &quot;postgres: autovacuum launcher &quot; ├─9063 &quot;postgres: stats collector &quot; └─9064 &quot;postgres: logical replication launcher &quot; fev 20 09:54:50 ws systemd[1]: Starting PostgreSQL database server... fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.090 -03 [9057] LOG: starting PostgreSQL 13.4 on x86_64-pc-linux-gnu, compiled by gcc (GCC) 11.1.0, 64-bit fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.091 -03 [9057] LOG: listening on IPv6 address &quot;::1&quot;, port 5432 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.091 -03 [9057] LOG: listening on IPv4 address &quot;127.0.0.1&quot;, port 5432 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.094 -03 [9057] LOG: listening on Unix socket &quot;/run/postgresql/.s.PGSQL.5432&quot; fev 20 09:54:51 ws postgres[9058]: 2022-02-20 09:54:51.100 -03 [9058] LOG: database system was shut down at 2022-02-20 09:52:34 -03 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.105 -03 [9057] LOG: database system is ready to accept connections fev 20 09:54:51 ws systemd[1]: Started PostgreSQL database server. Create Database in PostgreSQL To create a valid database, we first need a User. We can take advantage of the user that the system already makes available to us. $ sudo su - postgres Secure this default postgres user with a password: $ psql -c &quot;ALTER USER postgres WITH PASSWORD &#39;{new_password}&#39;&quot; To test and execute commands, let’s use the PostgreSQL cli. Type: psql Run the following command to create a database and then type \l to list the already created databases: CREATE DATABASE mydb; Create an User in PostgreSQL If you want a more assisted way, run this command: createuser --interactive --pwprompt If not, you can run those two to create a User with a password defined and a proper role for it: CREATE USER {user_name} WITH ENCRYPTED PASSWORD &#39;{user_password}&#39;; GRANT ALL PRIVILEGES ON DATABASE {db_name} TO {username}; Useful commands to run when using PSQL Login in to your user, run the psql command, and type: Connect to a database: \c {db_name} {username} List available databases: \l List available tables: \dt or \dt+ Describe a table: \d {table_name} List available schema: \dn List available functions: \df List available views: \dv List users and their roles: \du Execute the previous command (psql executes the previous command again, which is the SELECT statement): SELECT version(); \g Command history: \s Execute psql commands from a file: \i {filename} Turn on query execution time: db_name=# \timing Timing is on. db_name=# SELECT COUNT(*) FROM table; count ------- 1000 (1 row) Time: 0.495 ms db_name=# Edit command in your own editor. It will open the text editor defined in the EDITOR environment variable: \e" />
<link rel="canonical" href="https://sosolidkk.github.io//2022/02/20/psql.html" />
<meta property="og:url" content="https://sosolidkk.github.io//2022/02/20/psql.html" />
<meta property="og:site_name" content="&lt;~brain dump/&gt;" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-20T14:03:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PSQL" />
<script type="application/ld+json">
{"datePublished":"2022-02-20T14:03:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://sosolidkk.github.io//2022/02/20/psql.html"},"url":"https://sosolidkk.github.io//2022/02/20/psql.html","author":{"@type":"Person","name":"João Pedro"},"@type":"BlogPosting","headline":"PSQL","dateModified":"2022-02-20T14:03:00+00:00","description":"This one will also be another post about configuration since configuring Postgres and its user will always be a pain in the ass for me. Shall we? Installation $ sudo pacman -S postgresql Initial configuration After the succeeded installation, you can now switch to the postgres user using a privilege elevation program like: $ sudo su - postgres Before PostgreSQL can function correctly, the database cluster must be initialized: [postgres@{machine_name} ~]$ initdb -D /var/lib/postgres/data # If everything runs successfully you should see this output The database cluster will be initialized with locales COLLATE: en_US.UTF-8 CTYPE: en_US.UTF-8 MESSAGES: en_US.UTF-8 MONETARY: pt_BR.UTF-8 NUMERIC: pt_BR.UTF-8 TIME: pt_BR.UTF-8 The default database encoding has accordingly been set to &quot;UTF8&quot;. The default text search configuration will be set to &quot;english&quot;. Data page checksums are disabled. fixing permissions on existing directory /var/lib/postgres/data ... ok creating subdirectories ... ok selecting dynamic shared memory implementation ... posix selecting default max_connections ... 100 selecting default shared_buffers ... 128MB selecting default time zone ... America/Fortaleza creating configuration files ... ok running bootstrap script ... ok performing post-bootstrap initialization ... ok syncing data to disk ... ok initdb: warning: enabling &quot;trust&quot; authentication for local connections You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb. Success. You can now start the database server using: pg_ctl -D /var/lib/postgres/data -l logfile start Start postgreSQL: $ sudo systemctl start postgresql Enable postgreSQL service: $ sudo systemctl enable postgresql Check if PostgreSQL is active and running: ● postgresql.service - PostgreSQL database server Loaded: loaded (/usr/lib/systemd/system/postgresql.service; enabled; vendo&gt; Active: active (running) since Sun 2022-02-20 09:54:51 -03; 12s ago Main PID: 9057 (postgres) Tasks: 7 (limit: 19091) Memory: 15.8M CPU: 102ms CGroup: /system.slice/postgresql.service ├─9057 /usr/bin/postgres -D /var/lib/postgres/data ├─9059 &quot;postgres: checkpointer &quot; ├─9060 &quot;postgres: background writer &quot; ├─9061 &quot;postgres: walwriter &quot; ├─9062 &quot;postgres: autovacuum launcher &quot; ├─9063 &quot;postgres: stats collector &quot; └─9064 &quot;postgres: logical replication launcher &quot; fev 20 09:54:50 ws systemd[1]: Starting PostgreSQL database server... fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.090 -03 [9057] LOG: starting PostgreSQL 13.4 on x86_64-pc-linux-gnu, compiled by gcc (GCC) 11.1.0, 64-bit fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.091 -03 [9057] LOG: listening on IPv6 address &quot;::1&quot;, port 5432 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.091 -03 [9057] LOG: listening on IPv4 address &quot;127.0.0.1&quot;, port 5432 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.094 -03 [9057] LOG: listening on Unix socket &quot;/run/postgresql/.s.PGSQL.5432&quot; fev 20 09:54:51 ws postgres[9058]: 2022-02-20 09:54:51.100 -03 [9058] LOG: database system was shut down at 2022-02-20 09:52:34 -03 fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.105 -03 [9057] LOG: database system is ready to accept connections fev 20 09:54:51 ws systemd[1]: Started PostgreSQL database server. Create Database in PostgreSQL To create a valid database, we first need a User. We can take advantage of the user that the system already makes available to us. $ sudo su - postgres Secure this default postgres user with a password: $ psql -c &quot;ALTER USER postgres WITH PASSWORD &#39;{new_password}&#39;&quot; To test and execute commands, let’s use the PostgreSQL cli. Type: psql Run the following command to create a database and then type \\l to list the already created databases: CREATE DATABASE mydb; Create an User in PostgreSQL If you want a more assisted way, run this command: createuser --interactive --pwprompt If not, you can run those two to create a User with a password defined and a proper role for it: CREATE USER {user_name} WITH ENCRYPTED PASSWORD &#39;{user_password}&#39;; GRANT ALL PRIVILEGES ON DATABASE {db_name} TO {username}; Useful commands to run when using PSQL Login in to your user, run the psql command, and type: Connect to a database: \\c {db_name} {username} List available databases: \\l List available tables: \\dt or \\dt+ Describe a table: \\d {table_name} List available schema: \\dn List available functions: \\df List available views: \\dv List users and their roles: \\du Execute the previous command (psql executes the previous command again, which is the SELECT statement): SELECT version(); \\g Command history: \\s Execute psql commands from a file: \\i {filename} Turn on query execution time: db_name=# \\timing Timing is on. db_name=# SELECT COUNT(*) FROM table; count ------- 1000 (1 row) Time: 0.495 ms db_name=# Edit command in your own editor. It will open the text editor defined in the EDITOR environment variable: \\e","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://sosolidkk.github.io//feed.xml" title="&lt;~brain dump/&gt;" />
        







    
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">&lt;~brain dump/&gt;</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/portfolio/">Portfolio</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">PSQL</h1>
    <span class="post-tags">
      Tags: [&nbsp;
      
        
        <a class="no-underline" href="/tag/config">
          <code class="highligher-rouge">
            <nobr>config</nobr>
          </code>
        </a>&nbsp;
      
        
        <a class="no-underline" href="/tag/tips">
          <code class="highligher-rouge">
            <nobr>tips</nobr>
          </code>
        </a>&nbsp;
       ]
    </span>
    <p class="post-meta"><time class="dt-published" datetime="2022-02-20T14:03:00+00:00" itemprop="datePublished">
        Feb 20, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>This one will also be another post about configuration since configuring Postgres and its user will always be a pain in the ass for me. Shall we?</p>

<h4 id="installation"><strong>Installation</strong></h4>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">$ sudo pacman -S postgresql</code></p>
</blockquote>

<h4 id="initial-configuration"><strong>Initial configuration</strong></h4>
<p>After the succeeded installation, you can now switch to the postgres user using a <a href="https://wiki.archlinux.org/title/List_of_applications/Security#Privilege_elevation">privilege elevation</a> program like:</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">$ sudo su - postgres</code></p>
</blockquote>

<p>Before PostgreSQL can function correctly, the database cluster must be initialized:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>postgres@<span class="o">{</span>machine_name<span class="o">}</span> ~]<span class="nv">$ </span>initdb <span class="nt">-D</span> /var/lib/postgres/data
<span class="c"># If everything runs successfully you should see this output</span>
The database cluster will be initialized with locales
  COLLATE:  en_US.UTF-8
  CTYPE:    en_US.UTF-8
  MESSAGES: en_US.UTF-8
  MONETARY: pt_BR.UTF-8
  NUMERIC:  pt_BR.UTF-8
  TIME:     pt_BR.UTF-8
The default database encoding has accordingly been <span class="nb">set </span>to <span class="s2">"UTF8"</span><span class="nb">.</span>
The default text search configuration will be <span class="nb">set </span>to <span class="s2">"english"</span><span class="nb">.</span>

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/postgres/data ... ok
creating subdirectories ... ok
selecting dynamic shared memory implementation ... posix
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting default <span class="nb">time </span>zone ... America/Fortaleza
creating configuration files ... ok
running bootstrap script ... ok
performing post-bootstrap initialization ... ok
syncing data to disk ... ok

initdb: warning: enabling <span class="s2">"trust"</span> authentication <span class="k">for </span><span class="nb">local </span>connections
You can change this by editing pg_hba.conf or using the option <span class="nt">-A</span>, or
<span class="nt">--auth-local</span> and <span class="nt">--auth-host</span>, the next <span class="nb">time </span>you run initdb.

Success. You can now start the database server using:

    pg_ctl <span class="nt">-D</span> /var/lib/postgres/data <span class="nt">-l</span> logfile start
</code></pre></div></div>

<p>Start postgreSQL:</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">$ sudo systemctl start postgresql</code></p>
</blockquote>

<p>Enable postgreSQL service:</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">$ sudo systemctl enable postgresql</code></p>
</blockquote>

<p>Check if PostgreSQL is active and running:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>● postgresql.service - PostgreSQL database server
     Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/postgresql.service<span class="p">;</span> enabled<span class="p">;</span> vendo&gt;
     Active: active <span class="o">(</span>running<span class="o">)</span> since Sun 2022-02-20 09:54:51 <span class="nt">-03</span><span class="p">;</span> 12s ago
   Main PID: 9057 <span class="o">(</span>postgres<span class="o">)</span>
      Tasks: 7 <span class="o">(</span>limit: 19091<span class="o">)</span>
     Memory: 15.8M
        CPU: 102ms
     CGroup: /system.slice/postgresql.service
             ├─9057 /usr/bin/postgres <span class="nt">-D</span> /var/lib/postgres/data
             ├─9059 <span class="s2">"postgres: checkpointer "</span>
             ├─9060 <span class="s2">"postgres: background writer "</span>
             ├─9061 <span class="s2">"postgres: walwriter "</span>
             ├─9062 <span class="s2">"postgres: autovacuum launcher "</span>
             ├─9063 <span class="s2">"postgres: stats collector "</span>
             └─9064 <span class="s2">"postgres: logical replication launcher "</span>

fev 20 09:54:50 ws systemd[1]: Starting PostgreSQL database server...
fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.090 <span class="nt">-03</span> <span class="o">[</span>9057] LOG:  starting PostgreSQL 13.4 on x86_64-pc-linux-gnu, compiled by gcc <span class="o">(</span>GCC<span class="o">)</span> 11.1.0, 64-bit
fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.091 <span class="nt">-03</span> <span class="o">[</span>9057] LOG:  listening on IPv6 address <span class="s2">"::1"</span>, port 5432
fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.091 <span class="nt">-03</span> <span class="o">[</span>9057] LOG:  listening on IPv4 address <span class="s2">"127.0.0.1"</span>, port 5432
fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.094 <span class="nt">-03</span> <span class="o">[</span>9057] LOG:  listening on Unix socket <span class="s2">"/run/postgresql/.s.PGSQL.5432"</span>
fev 20 09:54:51 ws postgres[9058]: 2022-02-20 09:54:51.100 <span class="nt">-03</span> <span class="o">[</span>9058] LOG:  database system was shut down at 2022-02-20 09:52:34 <span class="nt">-03</span>
fev 20 09:54:51 ws postgres[9057]: 2022-02-20 09:54:51.105 <span class="nt">-03</span> <span class="o">[</span>9057] LOG:  database system is ready to accept connections
fev 20 09:54:51 ws systemd[1]: Started PostgreSQL database server.
</code></pre></div></div>

<h4 id="create-database-in-postgresql"><strong>Create Database in PostgreSQL</strong></h4>
<p>To create a valid database, we first need a User. We can take advantage of the user that the system already makes available to us.</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">$ sudo su - postgres</code></p>
</blockquote>

<p>Secure this default postgres user with a password:</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">$ psql -c "ALTER USER postgres WITH PASSWORD '{new_password}'"</code></p>
</blockquote>

<p>To test and execute commands, let’s use the PostgreSQL cli. Type:</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">psql</code></p>
</blockquote>

<p>Run the following command to create a database and then type <code class="language-plaintext highlighter-rouge">\l</code> to list the already created databases:</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">CREATE DATABASE mydb;</code></p>
</blockquote>

<h4 id="create-an-user-in-postgresql"><strong>Create an User in PostgreSQL</strong></h4>
<p>If you want a more assisted way, run this command:</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">createuser --interactive --pwprompt</code></p>
</blockquote>

<p>If not, you can run those two to create a User with a password defined and a proper role for it:</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">CREATE USER {user_name} WITH ENCRYPTED PASSWORD '{user_password}';</code></p>

  <p><code class="language-plaintext highlighter-rouge">GRANT ALL PRIVILEGES ON DATABASE {db_name} TO {username};</code></p>
</blockquote>

<h4 id="useful-commands-to-run-when-using-psql"><strong>Useful commands to run when using PSQL</strong></h4>
<p>Login in to your user, run the <code class="language-plaintext highlighter-rouge">psql</code> command, and type:</p>

<ul>
  <li>Connect to a database:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\c {db_name} {username}</code></p>
    </blockquote>
  </li>
  <li>List available databases:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\l</code></p>
    </blockquote>
  </li>
  <li>List available tables:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\dt or \dt+</code></p>
    </blockquote>
  </li>
  <li>Describe a table:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\d {table_name}</code></p>
    </blockquote>
  </li>
  <li>List available schema:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\dn</code></p>
    </blockquote>
  </li>
  <li>List available functions:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\df</code></p>
    </blockquote>
  </li>
  <li>List available views:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\dv</code></p>
    </blockquote>
  </li>
  <li>List users and their roles:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\du</code></p>
    </blockquote>
  </li>
  <li>Execute the previous command (<code class="language-plaintext highlighter-rouge">psql</code> executes the previous command again, which is the SELECT statement):
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">SELECT version();</code></p>

      <p><code class="language-plaintext highlighter-rouge">\g</code></p>
    </blockquote>
  </li>
  <li>Command history:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\s</code></p>
    </blockquote>
  </li>
  <li>Execute <code class="language-plaintext highlighter-rouge">psql</code> commands from a file:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\i {filename}</code></p>
    </blockquote>
  </li>
  <li>Turn on query execution time:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db_name=# \timing
Timing is on.
db_name=# SELECT COUNT(*) FROM table;
 count
-------
  1000
(1 row)

Time: 0.495 ms
db_name=#
</code></pre></div></div>

<ul>
  <li>Edit command in your own editor. It will open the text editor defined in the <code class="language-plaintext highlighter-rouge">EDITOR</code> environment variable:
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">\e</code></p>
    </blockquote>
  </li>
</ul>

  </div><a class="u-url" href="/2022/02/20/psql.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">João Pedro</li>
          <li><a class="u-email" href="mailto:pedrochaveslimas3@gmail.com">pedrochaveslimas3@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Don&#39;t take everything you read here too seriously. Enjoy your stay!</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/sosolidkk" target="_blank" title="sosolidkk"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.instagram.com/jpechaves" target="_blank" title="jpechaves"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#instagram"></use></svg></a></li><li><a rel="me" href="https://t.me/sosolidkk" target="_blank" title="sosolidkk"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#telegram"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
